{% extends "base.html" %}
{% block content %}
<div class="container py-4">
  <div class="d-flex justify-content-between align-items-center">
    <h4>Ventas</h4>
    <form class="d-flex" method="get">
      <select name="tipo" class="form-select form-select-sm me-2" style="width:auto">
        <option value="">Todos</option>
        <option value="01" {% if tipo == '01' %}selected{% endif %}>Factura (FE)</option>
        <option value="14" {% if tipo == '14' %}selected{% endif %}>Sujeto Excluido</option>
      </select>
      <button class="btn btn-sm btn-outline-secondary">Filtrar</button>
    </form>
  </div>

  <div class="table-responsive mt-3">
    <table class="table table-sm table-hover">
      <thead>
        <tr>
          <th>#</th><th>Tipo</th><th>Número</th><th>Cliente</th><th>Fecha</th><th class="text-end">Total</th><th>Estado</th><th></th>
        </tr>
      </thead>
      <tbody>
        {% for f in ventas %}
        <tr>
          <td>{{ f.id }}</td>
          <td>{{ f.tipo_dte.codigo }}</td>
          <td>{{ f.numero_control }}</td>
          <td>{{ f.dtereceptor.nombre }}</td>
          <td>{{ f.fecha_emision }}</td>
          <td class="text-end">${{ f.total_pagar }}</td>
          <td>
            {% if f.recibido_mh %}<span class="badge bg-success">Recibido MH</span>
            {% elif f.firmado %}<span class="badge bg-info">Firmado</span>
            {% else %}<span class="badge bg-secondary">Borrador</span>{% endif %}
          </td>
          <td class="text-end">
            <a class="btn btn-sm btn-outline-primary" href="{% url 'venta_detalle' f.id %}">Detalle</a>
            <a class="btn btn-sm btn-outline-warning" href="{% url 'devolucion_crear' f.id %}">Devolución</a>
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="8" class="text-center text-muted">Sin ventas</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
