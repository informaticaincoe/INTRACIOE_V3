<div class="modal fade" id="tomarOrdenModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-xl ">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title d-flex">
          <i class="bi bi-clipboard-check me-2"></i>
          <span class="mb-0">Tomar orden mesa</span>
          <p id="to_mesa_numero" class="ms-2 mb-0" readonly></p>
        </h5>
        <button type="button" class="btn-close mt-0 mb-0" data-bs-dismiss="modal"></button>
      </div>

      <form id="tomarOrdenForm" method="post" action="{% url 'pedido_crear_desde_mesa' %}">
        {% csrf_token %}

        <div class="modal-body">
          <input type="hidden" name="mesa_id" id="to_mesa_id">

          <!-- ✅ Aquí se inyecta el menú paginado -->
          <div id="tomarOrdenBody">
            <div class="text-muted small">Cargando menú...</div>
          </div>

        </div>

        <div class="modal-footer">
          <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-primary">
            <i class="bi bi-check2-circle me-1"></i> Enviar a cocina
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
<script src="https://unpkg.com/htmx.org@1.9.12"></script>
<script>
  document.addEventListener("shown.bs.modal", (ev) => {
    const modal = ev.target;
    if (!modal || modal.id !== "tomarOrdenModal") return;

    const trigger = ev.relatedTarget;
    if (!trigger) return;

    const mesaId = trigger.getAttribute("data-mesa-id");
    const mesaNumero = trigger.getAttribute("data-mesa-numero");

    document.getElementById("to_mesa_id").value = mesaId || "";
    document.getElementById("to_mesa_numero").textContent = mesaNumero || "";

    // ✅ Cargar el menú (página 1) desde el servidor dentro del modal
    const url = "{% url 'tomar_pedido' 0 %}".replace("/0/", `/${mesaId}/`);
    htmx.ajax("GET", url, "#tomarOrdenBody");
  });
</script>
